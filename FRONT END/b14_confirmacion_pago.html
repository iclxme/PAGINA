<!DOCTYPE html>
<html lang="es">
<head>
    <title>Confirmaci√≥n - Helader√≠a Deliciosa</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html">üç¶ Helader√≠a Deliciosa</a>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">

                <!-- Header -->
                <div class="row mb-4">
                    <div class="col-12 text-center">
                        <h1 class="display-4 text-primary">¬°Pedido Confirmado!</h1>
                        <p class="lead text-muted">Gracias por tu compra</p>
                    </div>
                </div>

                <!-- Mensaje de confirmaci√≥n -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="alert alert-success text-center shadow-sm">
                            <div class="display-4">üéâ</div>
                            <h4>¬°Pago Exitoso!</h4>
                            <p class="mb-0">Tu pedido ha sido procesado correctamente. Te hemos enviado un correo de confirmaci√≥n.</p>
                        </div>
                    </div>
                </div>

                <!-- Resumen del pedido -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card border shadow-sm">
                            <div class="card-header bg-light text-center fw-bold">
                                üìã Detalles del Pedido
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-12 col-md-6 mb-2">
                                        <strong>N√∫mero de Pedido:</strong><br>
                                        <span id="confirmationNumber"></span>
                                    </div>
                                    <div class="col-12 col-md-6 mb-2">
                                        <strong>Fecha de Entrega Estimada:</strong><br>
                                        <span id="deliveryDate"></span>
                                    </div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col-12 col-md-6 mb-2">
                                        <strong>M√©todo de Pago:</strong><br>
                                        <span id="paymentMethod"></span>
                                    </div>
                                    <div class="col-12 col-md-6 mb-2">
                                        <strong>Total Pagado:</strong><br>
                                        <span class="fw-bold text-success">$<span id="totalPaid">0</span></span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <strong>Direcci√≥n de Entrega:</strong><br>
                                        <span id="deliveryAddress"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Informaci√≥n del comprobante -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card border">
                            <div class="card-header bg-success bg-opacity-25 text-center fw-semibold">
                                üßæ Comprobante de Pago
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-12 col-md-4 mb-2">
                                        <strong>Fecha de Transacci√≥n:</strong><br>
                                        <span id="transactionDate"></span>
                                    </div>
                                    <div class="col-12 col-md-4 mb-2">
                                        <strong>C√≥digo de Autorizaci√≥n:</strong><br>
                                        <span id="authCode"></span>
                                    </div>
                                    <div class="col-12 col-md-4 mb-2">
                                        <strong>Estado:</strong><br>
                                        <span class="badge bg-success">Completado</span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12 col-md-6 mb-2">
                                        <strong>Email de Confirmaci√≥n:</strong><br>
                                        <span id="customerEmail">cliente@email.com</span>
                                    </div>
                                    <div class="col-12 col-md-6 mb-2">
                                        <strong>Tel√©fono de Contacto:</strong><br>
                                        <span>+56 9 1234 5678</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pr√≥ximos pasos -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card border-info">
                            <div class="card-header bg-info text-white text-center">
                                <h5 class="mb-0">üì¶ ¬øQu√© sigue?</h5>
                            </div>
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-6 col-md-3 mb-3">
                                        <div class="h1">üìß</div>
                                        <small>Recibir√°s un email de confirmaci√≥n</small>
                                    </div>
                                    <div class="col-6 col-md-3 mb-3">
                                        <div class="h1">üë®‚Äçüç≥</div>
                                        <small>Preparamos tu pedido con cuidado</small>
                                    </div>
                                    <div class="col-6 col-md-3 mb-3">
                                        <div class="h1">üöö</div>
                                        <small>Te lo entregamos en la fecha estimada</small>
                                    </div>
                                    <div class="col-6 col-md-3 mb-3">
                                        <div class="h1">‚≠ê</div>
                                        <small>Disfruta y califica tu experiencia</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- M√©todos de descarga -->
                <div class="row mb-4">
                    <div class="col-12 text-center d-flex flex-wrap justify-content-center gap-3">
                        <button class="btn btn-outline-secondary" onclick="downloadPDF()">
                            üìÑ Descargar Comprobante (PDF)
                        </button>
                        <button class="btn btn-primary" onclick="sendEmail()">
                            ‚úâÔ∏è Enviar por Email
                        </button>
                    </div>
                </div>

                <!-- Informaci√≥n adicional -->
                <div class="row mb-4">
                    <div class="col-12 text-center text-muted small">
                        <p>¬øTienes preguntas sobre tu pedido? Ll√°manos al +56 9 1234 5678 o escribe a pedidos@heladeriadeliciosa.cl</p>
                    </div>
                </div>

                <!-- Volver / Finalizar -->
                <div class="row">
                    <div class="col-12 text-center">
                        <a href="index.html" class="btn btn-success btn-lg">Volver al Inicio</a>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Funci√≥n para generar n√∫mero de pedido aleatorio
        function generarNumeroPedido() {
            const prefijos = ['HD', 'OR', 'PX', 'AC', 'ZT'];
            const prefijo = prefijos[Math.floor(Math.random() * prefijos.length)];
            const numero = Math.floor(100000 + Math.random() * 900000);
            return `${prefijo}-${numero}`;
        }

        // Funci√≥n para generar fecha de entrega aleatoria (2-7 d√≠as)
        function generarFechaEntrega() {
            const dias = Math.floor(2 + Math.random() * 6); // Entre 2 y 7 d√≠as
            const fecha = new Date(Date.now() + dias * 24 * 60 * 60 * 1000);
            return fecha.toLocaleDateString('es-ES', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        // Funci√≥n para generar c√≥digo de autorizaci√≥n aleatorio
        function generarCodigoAutorizacion() {
            return 'A' + Math.random().toString(36).substr(2, 9).toUpperCase();
        }

        // Funci√≥n para obtener nombre del m√©todo de pago
        function obtenerNombreMetodoPago(idMetodo) {
            const metodos = {
                'bancoLocal': 'Tarjeta de Cr√©dito/D√©bito',
                'tarjetaLocal': 'Transferencia Bancaria',
                'transferencia': 'Mercado Pago',
                'efectivo': 'Efectivo al retirar'
            };
            return metodos[idMetodo] || 'M√©todo de pago no especificado';
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Cargar informaci√≥n del pedido
            const lastOrder = JSON.parse(localStorage.getItem('lastOrder')) || {};
            
            // Si no hay informaci√≥n del pedido, generar datos aleatorios
            const orderNumber = lastOrder.orderNumber || generarNumeroPedido();
            const paymentMethod = lastOrder.paymentMethod || 'bancoLocal';
            const total = lastOrder.total || '0';
            const address = lastOrder.address || 'Calle Principal 123';
            const city = lastOrder.city || 'Santiago';
            const region = lastOrder.region || 'Regi√≥n Metropolitana';
            const postalCode = lastOrder.postalCode || '1234567';
            
            // Actualizar la interfaz
            document.getElementById('confirmationNumber').textContent = orderNumber;
            document.getElementById('deliveryDate').textContent = generarFechaEntrega();
            document.getElementById('paymentMethod').textContent = obtenerNombreMetodoPago(paymentMethod);
            document.getElementById('totalPaid').textContent = total;
            document.getElementById('deliveryAddress').textContent = `${address}, ${city}, ${region}, ${postalCode}`;
            document.getElementById('transactionDate').textContent = new Date().toLocaleString();
            document.getElementById('authCode').textContent = generarCodigoAutorizacion();

            // Cargar informaci√≥n del usuario si est√° logueado
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                document.getElementById('customerEmail').textContent = currentUser + '@email.com';
            }
        });

        function downloadPDF() {
            alert('üìÑ Descargando comprobante en PDF...');
            // En una implementaci√≥n real, aqu√≠ se generar√≠a y descargar√≠a el PDF
            setTimeout(() => {
                alert('‚úÖ Comprobante descargado correctamente');
            }, 1000);
        }

        function sendEmail() {
            alert('‚úâÔ∏è Enviando comprobante por email...');
            // En una implementaci√≥n real, aqu√≠ se enviar√≠a el email
            setTimeout(() => {
                alert('‚úÖ Comprobante enviado a tu correo electr√≥nico');
            }, 1000);
        }
    </script>
</body>
</html>