<!DOCTYPE html>
<html lang="es">
<head>
    <title>B√∫squeda Avanzada</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .navbar-brand {
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            font-size: 1.8rem;
            margin-right: 2rem;
        }
        
        .navbar-nav .nav-link {
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
        }
        
        .btn-cart {
            background-color: #FF6B6B;
            border: 2px solid #FF6B6B;
            color: white;
            border-radius: 30px;
            padding: 8px 20px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            text-decoration: none !important;
        }
        
        .btn-cart:hover {
            background-color: #e55a5a;
            border-color: #e55a5a;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
            text-decoration: none;
        }
        
        .custom-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            min-width: 300px;
            background-color: #06D6A0;
            color: white;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideInRight 0.5s ease-out;
        }
        
        .custom-notification i {
            font-size: 1.2rem;
        }
        
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .section-title {
            position: relative;
            margin-bottom: 3rem;
            text-align: center;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, #4A90E2, #FF6B6B);
            border-radius: 2px;
        }
        
        .filter-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .filter-option {
            cursor: pointer;
            transition: all 0.3s;
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 5px;
        }
        
        .filter-option:hover {
            background-color: #e9ecef;
        }
        
        .filter-option.active {
            background-color: #0d6efd;
            color: white;
        }
        
        .product-card {
            transition: transform 0.3s, box-shadow 0.3s;
            margin-bottom: 20px;
            border: none;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }
        
        .product-image {
            height: 180px;
            width: 100%;
            object-fit: cover;
            display: block;
        }
        
        .filter-header {
            background: linear-gradient(135deg, #4A90E2, #6B48FF);
            color: white;
            padding: 15px;
            border-radius: 10px 10px 0 0;
            margin-bottom: 15px;
        }
        
        .filter-group {
            margin-bottom: 15px;
        }
        
        .filter-group-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #4A90E2;
        }
        
        .form-control {
            border-radius: 10px;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            border-color: #4A90E2;
            box-shadow: 0 0 0 0.2rem rgba(74, 144, 226, 0.25);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4A90E2, #6B48FF);
            border: none;
            border-radius: 30px;
            padding: 12px 30px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 144, 226, 0.3);
        }
        
        .btn-outline-primary {
            border: 2px solid #4A90E2;
            color: #4A90E2;
            border-radius: 30px;
            padding: 8px 20px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-outline-primary:hover {
            background: #4A90E2;
            color: white;
            transform: translateY(-2px);
        }
        
        .btn-outline-secondary {
            border: 2px solid #6c757d;
            color: #6c757d;
            border-radius: 30px;
            padding: 8px 20px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-outline-secondary:hover {
            background: #6c757d;
            color: white;
            transform: translateY(-2px);
        }
        
        /* Estilos para el modal de personalizaci√≥n */
        .customization-option {
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 18px 15px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .customization-option:hover {
            border-color: #4A90E2;
            background-color: #f8f9ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.15);
        }
        
        .customization-option.selected {
            border-color: #4A90E2;
            background: linear-gradient(135deg, #e8f0fe, #f0f7ff);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.2);
        }
        
        .option-content {
            flex: 1;
        }
        
        .option-title {
            font-weight: 600;
            margin-bottom: 4px;
            color: #2c3e50;
            font-size: 1rem;
        }
        
        .option-subtitle {
            color: #6c757d;
            font-size: 0.85rem;
            margin-bottom: 0;
        }
        
        .option-price {
            color: #4A90E2;
            font-weight: 700;
            font-size: 1.1rem;
            text-align: right;
            min-width: 80px;
        }
        
        .option-price.free {
            color: #28a745;
        }
        
        .topping-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 0;
            border-bottom: 1px solid #f1f1f1;
            transition: all 0.2s ease;
        }
        
        .topping-item:hover {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 14px 12px;
            margin: 0 -12px;
        }
        
        .topping-item:last-child {
            border-bottom: none;
        }
        
        .topping-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .topping-name {
            font-weight: 500;
            color: #495057;
        }
        
        .total-price-section {
            background: linear-gradient(135deg, #f8f9ff, #e8f0fe);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e9ecef;
        }
        
        .total-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: #4A90E2;
        }
        
        .section-title-modal {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .product-info-modal {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .modal-content {
            border-radius: 18px;
            border: none;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .modal-header {
            border-bottom: 1px solid #e9ecef;
            border-radius: 18px 18px 0 0;
            padding: 25px 30px 20px;
            background: linear-gradient(135deg, #4A90E2, #6B48FF);
            color: white;
        }
        
        .modal-header .btn-close {
            filter: invert(1);
        }
        
        .modal-body {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .modal-footer {
            border-top: 1px solid #e9ecef;
            border-radius: 0 0 18px 18px;
            padding: 20px 30px;
        }
        
        .customization-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .form-check-input:checked {
            background-color: #4A90E2;
            border-color: #4A90E2;
        }
        
        .form-check-input:focus {
            border-color: #4A90E2;
            box-shadow: 0 0 0 0.2rem rgba(74, 144, 226, 0.25);
        }
        
        .popular-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #FFC107;
            color: #212529;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .no-products-message {
            text-align: center;
            padding: 60px 20px;
            border-radius: 15px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin: 20px 0;
        }
        
        .no-products-message i {
            font-size: 4rem;
            color: #6c757d;
            margin-bottom: 20px;
        }
        
        .no-products-message h4 {
            color: #495057;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .no-products-message p {
            color: #6c757d;
            max-width: 500px;
            margin: 0 auto 25px;
        }
        
        @media (max-width: 768px) {
            .customization-grid {
                grid-template-columns: 1fr;
            }
            
            .navbar-brand {
                margin-right: 1rem;
                font-size: 1.5rem;
            }
        }
        
        @media (max-width: 576px) {
            .navbar-brand {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">Fr√≠o Natural</a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="b04_catalogo.html">Cat√°logo</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="b05_filtros.html">B√∫squeda Avanzada</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="b06_disponibilidad.html">Disponibilidad</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="b07_promociones.html">Promociones</a>
                    </li>
                </ul>
                
                <div class="d-flex align-items-center">
                    <div class="position-relative me-3">
                        <a href="b12_editar_carrito.html" class="btn-cart position-relative">
                            <i class="fas fa-shopping-cart"></i> Carrito
                            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning" id="cartBadge">0</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4 mb-5">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12 text-center">
                <h1 class="display-5 text-primary section-title">B√∫squeda Avanzada</h1>
                <p class="text-muted">Encuentra tu helado ideal con nuestros filtros avanzados</p>
            </div>
        </div>

        <!-- Barra de b√∫squeda -->
        <div class="row mb-4 justify-content-center">
            <div class="col-12 col-md-8">
                <div class="input-group">
                    <input type="text" class="form-control" id="searchInput" placeholder="Buscar por sabor, ingrediente...">
                    <button class="btn btn-primary">
                        <i class="fas fa-search me-2"></i>Buscar
                    </button>
                </div>
            </div>
        </div>

        <!-- Secci√≥n de filtros -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="filter-header">
                        <h4 class="mb-0"><i class="fas fa-sliders-h me-2"></i>Filtros Avanzados</h4>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <!-- Filtro por Sabor -->
                            <div class="col-12 col-md-6 col-lg-3">
                                <div class="filter-section">
                                    <div class="filter-group-title">Sabor Principal</div>
                                    <div class="filter-option active" data-filter="sabor" data-value="all">Todos los sabores</div>
                                    <div class="filter-option" data-filter="sabor" data-value="vainilla">Vainilla</div>
                                    <div class="filter-option" data-filter="sabor" data-value="chocolate">Chocolate</div>
                                    <div class="filter-option" data-filter="sabor" data-value="frutilla">Frutilla</div>
                                    <div class="filter-option" data-filter="sabor" data-value="menta">Menta</div>
                                    <div class="filter-option" data-filter="sabor" data-value="lucuma">L√∫cuma</div>
                                    <div class="filter-option" data-filter="sabor" data-value="dulce-de-leche">Dulce de Leche</div>
                                </div>
                            </div>
                            
                            <!-- Filtro por Tipo -->
                            <div class="col-12 col-md-6 col-lg-3">
                                <div class="filter-section">
                                    <div class="filter-group-title">Tipo</div>
                                    <div class="filter-option active" data-filter="tipo" data-value="all">Todos los tipos</div>
                                    <div class="filter-option" data-filter="tipo" data-value="cremoso">Cremoso</div>
                                    <div class="filter-option" data-filter="tipo" data-value="frutal">Frutal</div>
                                    <div class="filter-option" data-filter="tipo" data-value="chocolate">Chocolate</div>
                                    <div class="filter-option" data-filter="tipo" data-value="especial">Especial</div>
                                    <div class="filter-option" data-filter="tipo" data-value="vegano">Vegano</div>
                                    <div class="filter-option" data-filter="tipo" data-value="sin-azucar">Sin Az√∫car</div>
                                </div>
                            </div>
                            
                            <!-- Filtro por Tama√±o -->
                            <div class="col-12 col-md-6 col-lg-3">
                                <div class="filter-section">
                                    <div class="filter-group-title">Tama√±o</div>
                                    <div class="filter-option active" data-filter="tama√±o" data-value="all">Todos los tama√±os</div>
                                    <div class="filter-option" data-filter="tama√±o" data-value="cono">Cono Individual</div>
                                    <div class="filter-option" data-filter="tama√±o" data-value="medio">1/2 Litro</div>
                                    <div class="filter-option" data-filter="tama√±o" data-value="litro">1 Litro</div>
                                    <div class="filter-option" data-filter="tama√±o" data-value="dos-litros">2 Litros</div>
                                </div>
                            </div>
                            
                            <!-- Filtro por Caracter√≠sticas Especiales -->
                            <div class="col-12 col-md-6 col-lg-3">
                                <div class="filter-section">
                                    <div class="filter-group-title">Caracter√≠sticas</div>
                                    <div class="filter-option" data-filter="caracteristicas" data-value="vegano">Vegano</div>
                                    <div class="filter-option" data-filter="caracteristicas" data-value="sin-azucar">Sin Az√∫car</div>
                                    <div class="filter-option" data-filter="caracteristicas" data-value="sin-lactosa">Sin Lactosa</div>
                                    <div class="filter-option" data-filter="caracteristicas" data-value="organico">Org√°nico</div>
                                    <div class="filter-option" data-filter="caracteristicas" data-value="premium">Premium</div>
                                </div>
                            </div>
                        </div>

                        <!-- Botones de acci√≥n -->
                        <div class="row mt-4">
                            <div class="col-12 d-flex justify-content-center gap-2 flex-wrap">
                                <button class="btn btn-primary" onclick="applyFilters()">
                                    <i class="fas fa-filter me-2"></i>Aplicar Filtros
                                </button>
                                <button class="btn btn-outline-secondary" onclick="clearFilters()">
                                    <i class="fas fa-times me-2"></i>Limpiar Filtros
                                </button>
                                <a href="b04_catalogo.html" class="btn btn-outline-primary">
                                    <i class="fas fa-list me-2"></i>Ver Cat√°logo Simple
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resultados -->
        <div class="row g-4" id="resultsContainer">
            <!-- Los resultados se cargar√°n aqu√≠ -->
        </div>

        <!-- Mensaje sin resultados -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="alert alert-warning text-center d-none" id="sin-resultados">
                    <h5>No encontramos resultados</h5>
                    <p class="mb-0">Intenta con otros filtros o t√©rminos de b√∫squeda.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Personalizaci√≥n -->
    <div class="modal fade" id="customizationModal" tabindex="-1" aria-labelledby="customizationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="customizationModalLabel">
                        <i class="fas fa-ice-cream me-2"></i>Personaliza tu helado
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Informaci√≥n del producto -->
                    <div class="product-info-modal">
                        <div class="row align-items-center">
                            <div class="col-md-3 text-center">
                                <img src="" id="modalProductImage" alt="Helado" class="img-fluid rounded" style="max-height: 100px; width: auto;">
                            </div>
                            <div class="col-md-9">
                                <h4 id="modalProductName" class="mb-1 text-dark"></h4>
                                <p id="modalProductDescription" class="text-muted mb-2"></p>
                                <div class="d-flex align-items-center">
                                    <span class="h5 text-primary mb-0">Precio base: $<span id="modalBasePriceDisplay">0</span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <!-- Selecci√≥n de tama√±o -->
                            <div class="mb-4">
                                <h6 class="section-title-modal">
                                    <i class="fas fa-weight me-2"></i>Tama√±o
                                </h6>
                                <div id="sizeOptions" class="customization-grid">
                                    <!-- Las opciones de tama√±o se cargar√°n din√°micamente -->
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <!-- Selecci√≥n de salsas -->
                                    <div class="mb-4">
                                        <h6 class="section-title-modal">
                                            <i class="fas fa-fill-drip me-2"></i>Salsas
                                        </h6>
                                        <div id="sauceOptions">
                                            <!-- Las opciones de salsas se cargar√°n din√°micamente -->
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <!-- Selecci√≥n de toppings -->
                                    <div class="mb-4">
                                        <h6 class="section-title-modal">
                                            <i class="fas fa-star me-2"></i>Toppings
                                        </h6>
                                        <div id="toppingOptions">
                                            <!-- Las opciones de toppings se cargar√°n din√°micamente -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Resumen del pedido -->
                    <div class="total-price-section">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">Total a pagar:</h6>
                                <small class="text-muted">Incluye personalizaciones seleccionadas</small>
                            </div>
                            <div class="text-end">
                                <span class="total-price">$<span id="modalTotalPrice">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" id="addToCartFinal">
                        <i class="fas fa-cart-plus me-2"></i>Agregar al Carrito
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-light py-5 bg-dark">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5>Fr√≠o Natural</h5>
                    <p>Los mejores helados artesanales desde 2010.</p>
                    <div class="social-icons mt-3">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Contacto</h5>
                    <p>üìç Calle Principal 123, Ciudad</p>
                    <p>üìû +56 9 1234 5678</p>
                    <p>‚úâÔ∏è info@frio-natural.cl</p>
                </div>
                <div class="col-md-4 mb-4">
                    <h5>Horarios</h5>
                    <p>Lunes a Viernes: 10:00 - 20:00</p>
                    <p>S√°bados y Domingos: 11:00 - 22:00</p>
                    <div class="footer-links mt-3">
                        <a href="b09_suscripcion.html" class="d-block text-light">Suscr√≠bete a nuestras ofertas</a>
                    </div>
                </div>
            </div>
            <hr class="my-4">
            <p class="text-center mb-0">&copy; 2025 Fr√≠o Natural. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Datos de productos
        const products = [
            { id: 1, name: "Vainilla Premium", tipo: "cremoso", sabor: "vainilla", tama√±o: ["medio", "litro"], caracteristicas: ["premium"], price: 4990, image: "HELADOS/vainilla-premium.png", popular: false, description: "Vainilla de la m√°s alta calidad con un sabor suave y cremoso." },
            { id: 2, name: "Chocolate Suizo", tipo: "chocolate", sabor: "chocolate", tama√±o: ["medio", "litro"], caracteristicas: ["premium"], price: 5990, image: "HELADOS/chocolate-suizo.png", popular: true, description: "Chocolate belga intenso con un toque de avellanas." },
            { id: 3, name: "Frutilla Natural", tipo: "frutal", sabor: "frutilla", tama√±o: ["medio", "litro"], caracteristicas: ["organico"], price: 5490, image: "HELADOS/frutilla-natural.png", popular: true, description: "Frutillas frescas en un helado cremoso y refrescante." },
            { id: 4, name: "Menta con Chocolate", tipo: "chocolate", sabor: "menta", tama√±o: ["cono", "medio"], caracteristicas: [], price: 5490, image: "HELADOS/menta-chocolate.png", popular: false, description: "Refrescante sabor a menta con trozos de chocolate." },
            { id: 5, name: "L√∫cuma Tradicional", tipo: "cremoso", sabor: "lucuma", tama√±o: ["litro", "dos-litros"], caracteristicas: [], price: 5990, image: "HELADOS/lucuma-tradicional.png", popular: false, description: "El aut√©ntico sabor peruano de l√∫cuma en un helado cremoso." },
            { id: 6, name: "Helado Vegano de Coco", tipo: "vegano", sabor: "coco", tama√±o: ["medio", "litro"], caracteristicas: ["vegano", "sin-lactosa"], price: 6490, image: "HELADOS/vegano-coco.png", popular: false, description: "Delicioso helado vegano a base de coco natural." },
            { id: 7, name: "Helado Sin Az√∫car", tipo: "sin-azucar", sabor: "vainilla", tama√±o: ["medio", "litro"], caracteristicas: ["sin-azucar"], price: 5490, image: "HELADOS/sin-azucar.png", popular: false, description: "Helado de vainilla sin az√∫car a√±adida, perfecto para dietas especiales." },
            { id: 8, name: "Dulce de Leche", tipo: "cremoso", sabor: "dulce-de-leche", tama√±o: ["medio", "litro"], caracteristicas: [], price: 5290, image: "HELADOS/dulce-leche.png", popular: true, description: "El cl√°sico sabor argentino en su versi√≥n m√°s cremosa." }
        ];

        // Opciones de personalizaci√≥n
        const sizeOptions = [
            { id: 1, name: "Porci√≥n Individual", subtitle: "1 bola perfecta", price: 0 },
            { id: 2, name: "Porci√≥n Doble", subtitle: "2 bolas deliciosas", price: 1500 },
            { id: 3, name: "Porci√≥n Familiar", subtitle: "3 bolas para compartir", price: 2500 },
            { id: 4, name: "Medio Kilo", subtitle: "¬Ω kg de puro placer", price: 8900 },
            { id: 5, name: "Un Kilo", subtitle: "1 kg de felicidad", price: 15900 },
            { id: 6, name: "Dos Kilos", subtitle: "2 kg para festejar", price: 28900 }
        ];

        // Salsas
        const sauceOptions = [
            { id: 1, name: "Chocolate", price: 800 },
            { id: 2, name: "Caramelo", price: 800 },
            { id: 3, name: "Frutilla", price: 800 },
            { id: 4, name: "Dulce de Leche", price: 800 },
            { id: 5, name: "Chocolate Blanco", price: 900 },
            { id: 6, name: "Frambuesa", price: 800 }
        ];

        // Toppings
        const toppingOptions = [
            { id: 1, name: "Granas de Chocolate", price: 500 },
            { id: 2, name: "Nueces Crocantes", price: 700 },
            { id: 3, name: "Frutillas Frescas", price: 900 },
            { id: 4, name: "Coco Rallado", price: 400 },
            { id: 5, name: "Chispas de Colores", price: 300 },
            { id: 6, name: "Crema Chantilly", price: 600 },
            { id: 7, name: "Galletas Trituradas", price: 550 },
            { id: 8, name: "Sirope de Arce", price: 750 }
        ];

        let currentFilters = {
            sabor: 'all',
            tipo: 'all',
            tama√±o: 'all',
            caracteristicas: 'all',
            search: ''
        };

        let currentProduct = null;
        let selectedSize = null;
        let selectedSauces = [];
        let selectedToppings = [];

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            setupFilterOptions();
            loadResults();
            updateCartBadge();
            
            // Configurar b√∫squeda en tiempo real
            document.getElementById('searchInput').addEventListener('input', function(e) {
                currentFilters.search = this.value;
                loadResults();
            });
            
            // Evento para agregar al carrito desde el modal
            document.getElementById('addToCartFinal').addEventListener('click', function() {
                addCustomizedToCart();
            });
        });

        function setupFilterOptions() {
            // Configurar eventos para las opciones de filtro
            document.querySelectorAll('.filter-option').forEach(option => {
                option.addEventListener('click', function() {
                    const filterType = this.getAttribute('data-filter');
                    const filterValue = this.getAttribute('data-value');
                    
                    // Para caracter√≠sticas, permitir m√∫ltiples selecciones
                    if (filterType === 'caracteristicas') {
                        this.classList.toggle('active');
                        return;
                    }
                    
                    // Para otros filtros, selecci√≥n √∫nica
                    // Remover activo de otras opciones del mismo tipo
                    document.querySelectorAll(`[data-filter="${filterType}"]`).forEach(opt => {
                        opt.classList.remove('active');
                    });
                    
                    // Activar la opci√≥n seleccionada
                    this.classList.add('active');
                    
                    // Actualizar filtros
                    currentFilters[filterType] = filterValue;
                });
            });

            // B√∫squeda al presionar Enter
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    loadResults();
                }
            });
        }

        function loadResults() {
            const container = document.getElementById('resultsContainer');
            const noResults = document.getElementById('sin-resultados');
            container.innerHTML = '';
            
            // Obtener caracter√≠sticas seleccionadas
            const selectedCharacteristics = [];
            document.querySelectorAll('[data-filter="caracteristicas"].active').forEach(option => {
                selectedCharacteristics.push(option.getAttribute('data-value'));
            });
            
            let filteredProducts = products.filter(product => {
                const saborMatch = currentFilters.sabor === 'all' || product.sabor === currentFilters.sabor;
                const tipoMatch = currentFilters.tipo === 'all' || product.tipo === currentFilters.tipo;
                const tama√±oMatch = currentFilters.tama√±o === 'all' || product.tama√±o.includes(currentFilters.tama√±o);
                const searchMatch = !currentFilters.search || 
                    product.name.toLowerCase().includes(currentFilters.search.toLowerCase());
                
                // Verificar caracter√≠sticas
                let characteristicsMatch = true;
                if (selectedCharacteristics.length > 0) {
                    characteristicsMatch = selectedCharacteristics.every(char => 
                        product.caracteristicas.includes(char)
                    );
                }
                
                return saborMatch && tipoMatch && tama√±oMatch && searchMatch && characteristicsMatch;
            });
            
            if (filteredProducts.length === 0) {
                noResults.classList.remove('d-none');
                container.innerHTML = `
                    <div class="col-12">
                        <div class="no-products-message">
                            <i class="fas fa-search"></i>
                            <h4>No encontramos resultados</h4>
                            <p>No hay productos que coincidan con tu b√∫squeda. Intenta con otros t√©rminos o revisa los filtros aplicados.</p>
                            <button class="btn btn-outline-secondary" onclick="clearFilters()">
                                <i class="fas fa-times me-2"></i>Limpiar Filtros
                            </button>
                        </div>
                    </div>
                `;
                return;
            }
            
            noResults.classList.add('d-none');
            
            filteredProducts.forEach(product => {
                const productCard = `
                    <div class="col-md-6 col-lg-4">
                        <div class="card product-card h-100">
                            ${product.popular ? '<div class="popular-badge"><i class="fas fa-star me-1"></i>Popular</div>' : ''}
                            <img src="${product.image}" alt="${product.name}" class="product-image">
                            <div class="card-body text-center">
                                <h5>${product.name}</h5>
                                <p class="text-muted">${product.tipo.charAt(0).toUpperCase() + product.tipo.slice(1)} ‚Ä¢ ${product.tama√±o.join(', ')}</p>
                                ${product.caracteristicas.length > 0 ? 
                                    `<div class="mb-2">
                                        ${product.caracteristicas.map(char => 
                                            `<span class="badge bg-info me-1">${char}</span>`
                                        ).join('')}
                                    </div>` : ''
                                }
                                <p class="h4 text-primary">$${product.price.toLocaleString()}</p>
                                <button class="btn btn-outline-primary" onclick="openCustomizationModal(${product.id})">
                                    Agregar al Carrito
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += productCard;
            });
        }

        function openCustomizationModal(productId) {
            // Reiniciar selecciones
            selectedSize = null;
            selectedSauces = [];
            selectedToppings = [];
            
            // Encontrar el producto
            currentProduct = products.find(p => p.id === productId);
            
            if (!currentProduct) return;
            
            // Actualizar informaci√≥n del producto en el modal
            document.getElementById('modalProductName').textContent = currentProduct.name;
            document.getElementById('modalProductDescription').textContent = currentProduct.description;
            document.getElementById('modalProductImage').src = currentProduct.image;
            document.getElementById('modalBasePriceDisplay').textContent = currentProduct.price.toLocaleString();
            
            // Cargar opciones de tama√±o
            const sizeContainer = document.getElementById('sizeOptions');
            sizeContainer.innerHTML = '';
            sizeOptions.forEach(size => {
                const priceDisplay = size.price > 0 ? `+$${size.price.toLocaleString()}` : 'Incluido';
                const priceClass = size.price > 0 ? '' : 'free';
                
                const sizeElement = `
                    <div class="customization-option" onclick="selectSize(${size.id})">
                        <div class="option-content">
                            <div class="option-title">${size.name}</div>
                            <div class="option-subtitle">${size.subtitle}</div>
                        </div>
                        <div class="option-price ${priceClass}">${priceDisplay}</div>
                    </div>
                `;
                sizeContainer.innerHTML += sizeElement;
            });
            
            // Cargar opciones de salsas
            const sauceContainer = document.getElementById('sauceOptions');
            sauceContainer.innerHTML = '';
            sauceOptions.forEach(sauce => {
                const sauceElement = `
                    <div class="topping-item">
                        <div class="topping-info">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="sauce-${sauce.id}" onchange="toggleSauce(${sauce.id}, this.checked)">
                                <label class="form-check-label topping-name" for="sauce-${sauce.id}">
                                    ${sauce.name}
                                </label>
                            </div>
                        </div>
                        <span class="option-price">+$${sauce.price.toLocaleString()}</span>
                    </div>
                `;
                sauceContainer.innerHTML += sauceElement;
            });
            
            // Cargar opciones de toppings
            const toppingContainer = document.getElementById('toppingOptions');
            toppingContainer.innerHTML = '';
            toppingOptions.forEach(topping => {
                const toppingElement = `
                    <div class="topping-item">
                        <div class="topping-info">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="topping-${topping.id}" onchange="toggleTopping(${topping.id}, this.checked)">
                                <label class="form-check-label topping-name" for="topping-${topping.id}">
                                    ${topping.name}
                                </label>
                            </div>
                        </div>
                        <span class="option-price">+$${topping.price.toLocaleString()}</span>
                    </div>
                `;
                toppingContainer.innerHTML += toppingElement;
            });
            
            // Actualizar precio total
            updateTotalPrice();
            
            // Mostrar modal
            const modal = new bootstrap.Modal(document.getElementById('customizationModal'));
            modal.show();
        }

        function selectSize(sizeId) {
            selectedSize = sizeOptions.find(s => s.id === sizeId);
            
            // Actualizar UI
            document.querySelectorAll('#sizeOptions .customization-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.target.closest('.customization-option').classList.add('selected');
            
            updateTotalPrice();
        }

        function toggleSauce(sauceId, isChecked) {
            const sauce = sauceOptions.find(s => s.id === sauceId);
            
            if (isChecked) {
                selectedSauces.push(sauce);
            } else {
                selectedSauces = selectedSauces.filter(s => s.id !== sauceId);
            }
            
            updateTotalPrice();
        }

        function toggleTopping(toppingId, isChecked) {
            const topping = toppingOptions.find(t => t.id === toppingId);
            
            if (isChecked) {
                selectedToppings.push(topping);
            } else {
                selectedToppings = selectedToppings.filter(t => t.id !== toppingId);
            }
            
            updateTotalPrice();
        }

        function updateTotalPrice() {
            let total = currentProduct ? currentProduct.price : 0;
            
            if (selectedSize) {
                total += selectedSize.price;
            }
            
            selectedSauces.forEach(sauce => {
                total += sauce.price;
            });
            
            selectedToppings.forEach(topping => {
                total += topping.price;
            });
            
            document.getElementById('modalTotalPrice').textContent = total.toLocaleString();
        }

        function addCustomizedToCart() {
            if (!currentProduct) return;
            
            if (!selectedSize) {
                alert('Por favor selecciona un tama√±o para tu helado.');
                return;
            }
            
            // Calcular precio total
            let totalPrice = currentProduct.price;
            totalPrice += selectedSize.price;
            
            selectedSauces.forEach(sauce => {
                totalPrice += sauce.price;
            });
            
            selectedToppings.forEach(topping => {
                totalPrice += topping.price;
            });
            
            // Crear descripci√≥n personalizada
            let description = `${currentProduct.name} - ${selectedSize.name}`;
            
            if (selectedSauces.length > 0) {
                description += ` con ${selectedSauces.map(s => s.name).join(', ')}`;
            }
            
            if (selectedToppings.length > 0) {
                description += ` y ${selectedToppings.map(t => t.name).join(', ')}`;
            }
            
            // Agregar al carrito
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            cart.push({
                id: Date.now(), // ID √∫nico para este item personalizado
                name: description,
                price: totalPrice,
                quantity: 1,
                baseProduct: currentProduct.id,
                size: selectedSize.id,
                sauces: selectedSauces.map(s => s.id),
                toppings: selectedToppings.map(t => t.id)
            });
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartBadge();
            
            // Cerrar modal y mostrar notificaci√≥n
            const modal = bootstrap.Modal.getInstance(document.getElementById('customizationModal'));
            modal.hide();
            
            showNotification(`¬°${description} agregado al carrito!`);
        }

        function applyFilters() {
            loadResults();
        }

        function clearFilters() {
            currentFilters = {
                sabor: 'all',
                tipo: 'all',
                tama√±o: 'all',
                caracteristicas: 'all',
                search: ''
            };
            
            document.querySelectorAll('.filter-option').forEach(opt => {
                opt.classList.remove('active');
                if (opt.getAttribute('data-value') === 'all') {
                    opt.classList.add('active');
                }
            });
            
            document.getElementById('searchInput').value = '';
            loadResults();
        }

        function updateCartBadge() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartBadge').textContent = totalItems;
        }
        
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'custom-notification';
            notification.innerHTML = `
                <i class="fas fa-check-circle"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>