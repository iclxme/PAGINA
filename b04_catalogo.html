<!DOCTYPE html>
<html lang="es">
<head>
    <title>Catálogo - Heladería Deliciosa</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .product-card {
            transition: transform 0.3s;
        }
        .product-card:hover {
            transform: translateY(-5px);
        }
        .flavor-badge {
            cursor: pointer;
        }
        .flavor-badge.active {
            border: 2px solid #0d6efd;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html">🍦 Heladería Deliciosa</a>
            <div class="navbar-nav ms-auto">
                <a href="b12_editar_carrito.html" class="btn btn-outline-light position-relative">
                    🛒 Carrito
                    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="cartBadge">0</span>
                </a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12 text-center">
                <h1 class="display-4 text-primary">Nuestros Helados</h1>
                <p class="lead text-muted">Descubre nuestra deliciosa variedad de sabores</p>
            </div>
        </div>

        <!-- Barra de Búsqueda -->
        <div class="row mb-4">
            <div class="col-12 col-md-8 mx-auto">
                <div class="input-group">
                    <input type="text" class="form-control" id="searchInput" placeholder="Buscar sabores...">
                    <button class="btn btn-primary" onclick="searchProducts()">Buscar</button>
                </div>
            </div>
        </div>

        <!-- Filtros -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">Filtrar por:</h5>
                        <div class="row g-3">
                            <div class="col-12 col-md-4">
                                <label class="form-label">Categoría</label>
                                <select class="form-select" id="categoryFilter">
                                    <option value="all">Todas las categorías</option>
                                    <option value="cremoso">Cremosos</option>
                                    <option value="frutal">Frutales</option>
                                    <option value="chocolate">Chocolate</option>
                                    <option value="especial">Especiales</option>
                                </select>
                            </div>
                            <div class="col-12 col-md-4">
                                <label class="form-label">Precio máximo</label>
                                <select class="form-select" id="priceFilter">
                                    <option value="9999">Cualquier precio</option>
                                    <option value="5000">Hasta $5.000</option>
                                    <option value="7000">Hasta $7.000</option>
                                    <option value="10000">Hasta $10.000</option>
                                </select>
                            </div>
                            <div class="col-12 col-md-4">
                                <label class="form-label">Ordenar por</label>
                                <select class="form-select" id="sortFilter">
                                    <option value="name">Nombre A-Z</option>
                                    <option value="price-asc">Precio: Menor a Mayor</option>
                                    <option value="price-desc">Precio: Mayor a Menor</option>
                                    <option value="popular">Más populares</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Filtros rápidos por sabor -->
                        <div class="mt-3">
                            <label class="form-label">Sabores populares:</label>
                            <div class="d-flex flex-wrap gap-2" id="flavorFilters">
                                <span class="badge bg-secondary flavor-badge active" data-flavor="all">Todos</span>
                                <span class="badge bg-secondary flavor-badge" data-flavor="vainilla">Vainilla</span>
                                <span class="badge bg-secondary flavor-badge" data-flavor="chocolate">Chocolate</span>
                                <span class="badge bg-secondary flavor-badge" data-flavor="frutilla">Frutilla</span>
                                <span class="badge bg-secondary flavor-badge" data-flavor="menta">Menta</span>
                                <span class="badge bg-secondary flavor-badge" data-flavor="lucuma">Lúcuma</span>
                            </div>
                        </div>

                        <!-- Botones de acción -->
                        <div class="row mt-4">
                            <div class="col-12 d-flex justify-content-center gap-2 flex-wrap">
                                <button class="btn btn-primary" onclick="applyFilters()">Aplicar Filtros</button>
                                <button class="btn btn-outline-secondary" onclick="clearFilters()">Limpiar Filtros</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Catálogo de Productos -->
        <div class="row g-4" id="productsContainer">
            <!-- Los productos se cargarán dinámicamente aquí -->
        </div>

        <!-- Paginación -->
        <div class="row mt-5">
            <div class="col-12 d-flex justify-content-center">
                <nav>
                    <ul class="pagination">
                        <li class="page-item disabled"><a class="page-link" href="#">Anterior</a></li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item"><a class="page-link" href="#">Siguiente</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Datos de productos
        const products = [
            { id: 1, name: "Vainilla Premium", category: "cremoso", price: 4990, flavor: "vainilla", image: "🍦", popular: true },
            { id: 2, name: "Chocolate Suizo", category: "chocolate", price: 5990, flavor: "chocolate", image: "🍫", popular: true },
            { id: 3, name: "Frutilla Natural", category: "frutal", price: 5490, flavor: "frutilla", image: "🍓", popular: true },
            { id: 4, name: "Menta con Chocolate", category: "chocolate", price: 5490, flavor: "menta", image: "🌿", popular: false },
            { id: 5, name: "Lúcuma Tradicional", category: "cremoso", price: 5990, flavor: "lucuma", image: "🥭", popular: true },
            { id: 6, name: "Dulce de Leche", category: "cremoso", price: 5290, flavor: "dulce-de-leche", image: "🥛", popular: false },
            { id: 7, name: "Frambuesa Silvestre", category: "frutal", price: 5790, flavor: "frambuesa", image: "🫐", popular: false },
            { id: 8, name: "Cookies & Cream", category: "especial", price: 6290, flavor: "cookies", image: "🍪", popular: true }
        ];

        let currentFilters = {
            category: 'all',
            price: 9999,
            flavor: 'all',
            search: '',
            sort: 'name'
        };

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            setupEventListeners();
            updateCartBadge();
        });

        function setupEventListeners() {
            // Filtros de sabor
            document.querySelectorAll('.flavor-badge').forEach(badge => {
                badge.addEventListener('click', function() {
                    document.querySelectorAll('.flavor-badge').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFilters.flavor = this.getAttribute('data-flavor');
                    loadProducts();
                });
            });

            // Búsqueda al presionar Enter
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchProducts();
                }
            });
        }

        function loadProducts() {
            const container = document.getElementById('productsContainer');
            container.innerHTML = '';
            
            let filteredProducts = products.filter(product => {
                const categoryMatch = currentFilters.category === 'all' || product.category === currentFilters.category;
                const priceMatch = product.price <= currentFilters.price;
                const flavorMatch = currentFilters.flavor === 'all' || product.flavor === currentFilters.flavor;
                const searchMatch = !currentFilters.search || 
                    product.name.toLowerCase().includes(currentFilters.search.toLowerCase());
                
                return categoryMatch && priceMatch && flavorMatch && searchMatch;
            });

            // Ordenar productos
            filteredProducts.sort((a, b) => {
                switch(currentFilters.sort) {
                    case 'price-asc':
                        return a.price - b.price;
                    case 'price-desc':
                        return b.price - a.price;
                    case 'popular':
                        return (b.popular ? 1 : 0) - (a.popular ? 1 : 0);
                    default:
                        return a.name.localeCompare(b.name);
                }
            });
            
            if (filteredProducts.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center">
                        <div class="alert alert-warning">
                            <h5>No se encontraron productos</h5>
                            <p>Intenta con otros filtros de búsqueda.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            filteredProducts.forEach(product => {
                const productCard = `
                    <div class="col-md-6 col-lg-3 mb-4">
                        <div class="card product-card shadow-sm h-100">
                            <div class="card-body text-center">
                                <div class="display-4 mb-3">${product.image}</div>
                                <h5 class="card-title">${product.name}</h5>
                                <p class="card-text text-muted">${getCategoryName(product.category)}</p>
                                <p class="h4 text-primary">$${product.price.toLocaleString()}</p>
                                <button class="btn btn-outline-primary" onclick="addToCart(${product.id}, '${product.name}', ${product.price})">
                                    Agregar al Carrito
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += productCard;
            });
        }

        function getCategoryName(category) {
            const categories = {
                'cremoso': 'Cremoso',
                'frutal': 'Frutal',
                'chocolate': 'Chocolate',
                'especial': 'Especial'
            };
            return categories[category] || category;
        }

        function applyFilters() {
            currentFilters.category = document.getElementById('categoryFilter').value;
            currentFilters.price = parseInt(document.getElementById('priceFilter').value);
            currentFilters.sort = document.getElementById('sortFilter').value;
            loadProducts();
        }

        function clearFilters() {
            document.getElementById('categoryFilter').value = 'all';
            document.getElementById('priceFilter').value = '9999';
            document.getElementById('sortFilter').value = 'name';
            document.getElementById('searchInput').value = '';
            document.querySelectorAll('.flavor-badge').forEach(b => b.classList.remove('active'));
            document.querySelector('.flavor-badge[data-flavor="all"]').classList.add('active');
            
            currentFilters = {
                category: 'all',
                price: 9999,
                flavor: 'all',
                search: '',
                sort: 'name'
            };
            
            loadProducts();
        }

        function searchProducts() {
            currentFilters.search = document.getElementById('searchInput').value;
            loadProducts();
        }

        function addToCart(id, name, price) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const existingItem = cart.find(item => item.id === id);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ id, name, price, quantity: 1 });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartBadge();
            alert(`¡${name} agregado al carrito!`);
        }

        function updateCartBadge() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartBadge').textContent = totalItems;
        }
    </script>
</body>
</html>